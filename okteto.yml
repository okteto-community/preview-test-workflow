build:
  app-dev:
    context: app
    target: base

deploy:
  compose: docker-compose.yml

dev:
  app:
    command: yarn dev
    environment:
      HOSTNAME: "0.0.0.0"
      NODE_ENV: "development"
    image: $OKTETO_BUILD_APP_DEV_IMAGE
    sync:
    - app:/app

test:
  e2e:
    image: cypress/included:13.6.1
    caches:
      - /root/.cache
      - /root/.yarn
    context: tests
    commands:
      - yarn install --frozen-lockfile
      - CYPRESS_BASE_URL=https://app-${OKTETO_NAMESPACE}.${OKTETO_DOMAIN} yarn cypress:run --config video=false,screenshotOnRunFailure=false